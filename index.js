// index.js

let argv = require('yargs')
	.usage('Usage: $0 [cve list]')
	.example('$0 CVE-2020-24589', 'extracts the CVE and WSO2 Security Advisory information')
	.help('h')
	.alias('h', 'help').argv;

const ora = require('ora');
const { scrapeData } = require('./scrape/index.nvd');

let args = {};
args.cves = argv._;

(async () => {
	let security = [];
	for (let vulnerableID of args.cves) {
		const spinner = ora(`scraping ${vulnerableID}`).start();
		try {
			security.push(await scrapeData(vulnerableID));
			spinner.succeed();
		} catch (err) {
			if (spinner.isSpinning) spinner.fail();
		}
	}
	console.dir(security, { depth: 5 });
})();
